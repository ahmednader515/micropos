(()=>{var e={};e.id=798,e.ids=[798],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},71017:e=>{"use strict";e.exports=require("path")},85477:e=>{"use strict";e.exports=require("punycode")},63477:e=>{"use strict";e.exports=require("querystring")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},16867:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>c});var s=r(50482),i=r(69108),a=r(62563),o=r.n(a),n=r(68300),l={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);r.d(t,l);let c=["",{children:["inventory",{children:["products",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,75688)),"C:\\Users\\PC\\Desktop\\micropos\\app\\inventory\\products\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,82917)),"C:\\Users\\PC\\Desktop\\micropos\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,69361,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\PC\\Desktop\\micropos\\app\\inventory\\products\\page.tsx"],u="/inventory/products/page",x={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/inventory/products/page",pathname:"/inventory/products",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},43708:(e,t,r)=>{Promise.resolve().then(r.bind(r,67440))},67440:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var s=r(95344),i=r(3729),a=r(67923);function o({message:e,type:t,isVisible:r,onClose:a,duration:o=4e3}){let[n,l]=(0,i.useState)(!1);return((0,i.useEffect)(()=>{if(r){l(!0);let e=setTimeout(()=>{l(!1),setTimeout(a,300)},o);return()=>clearTimeout(e)}},[r,o,a]),r)?s.jsx("div",{className:`fixed top-4 left-4 right-4 z-50 transform transition-all duration-300 ${n?"translate-y-0 opacity-100":"-translate-y-2 opacity-0"}`,children:s.jsx("div",{className:`max-w-sm mx-auto border rounded-lg p-4 shadow-lg ${(()=>{switch(t){case"success":return"bg-green-50 border-green-200 text-green-800";case"error":return"bg-red-50 border-red-200 text-red-800";case"info":return"bg-blue-50 border-blue-200 text-blue-800";default:return"bg-gray-50 border-gray-200 text-gray-800"}})()}`,children:(0,s.jsxs)("div",{className:"flex items-start",children:[s.jsx("div",{className:"flex-shrink-0",children:(()=>{switch(t){case"success":return s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})});case"error":return s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})});case"info":return s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})});default:return null}})()}),s.jsx("div",{className:"mr-3 flex-1",children:s.jsx("p",{className:"text-sm font-medium",children:e})}),s.jsx("div",{className:"flex-shrink-0",children:s.jsx("button",{onClick:()=>{l(!1),setTimeout(a,300)},className:"inline-flex text-gray-400 hover:text-gray-600 focus:outline-none",children:s.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})})]})})}):null}var n=r(18999);function l(){let[e,t]=(0,i.useState)([]),[r,l]=(0,i.useState)(!0),[c,d]=(0,i.useState)(""),[u,x]=(0,i.useState)(null),[p,m]=(0,i.useState)(!1),[h,g]=(0,i.useState)(!1),[y,f]=(0,i.useState)({stock:"",price:""}),[b,v]=(0,i.useState)(!1),[j,w]=(0,i.useState)({message:"",type:"info",isVisible:!1});(0,i.useEffect)(()=>{N()},[]);let N=async()=>{try{let e=await fetch("/api/products/inventory");if(e.ok){let r=await e.json();t(r.products)}}catch(e){console.error("Error fetching products:",e)}finally{l(!1)}},k=e.filter(e=>e.name.toLowerCase().includes(c.toLowerCase())||e.barcode&&e.barcode.toLowerCase().includes(c.toLowerCase())||e.sku&&e.sku.toLowerCase().includes(c.toLowerCase())),C=e=>{x(e),f({stock:e.stock.toString(),price:e.price.toString()}),m(!0)},q=(e,t="info")=>{w({message:e,type:t,isVisible:!0})},P=async()=>{if(u){v(!0);try{(await fetch(`/api/products/${u.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({stock:parseInt(y.stock),price:parseFloat(y.price)})})).ok?(q("تم تحديث المنتج بنجاح","success"),m(!1),N()):q("فشل في تحديث المنتج","error")}catch(e){console.error("Error updating product:",e),q("حدث خطأ أثناء تحديث المنتج","error")}finally{v(!1)}}},L=async e=>{if(confirm("هل أنت متأكد من حذف هذا المنتج؟"))try{(await fetch(`/api/products/${e}`,{method:"DELETE"})).ok?(q("تم حذف المنتج بنجاح","success"),m(!1),N()):q("فشل في حذف المنتج","error")}catch(e){console.error("Error deleting product:",e),q("حدث خطأ أثناء حذف المنتج","error")}},M=async e=>{try{(await fetch(`/api/products/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:!1})})).ok?(q("تم تجميد المنتج بنجاح","success"),m(!1),N()):q("فشل في تجميد المنتج","error")}catch(e){console.error("Error freezing product:",e),q("حدث خطأ أثناء تجميد المنتج","error")}},_=async e=>{try{(await fetch(`/api/products/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:!0})})).ok?(q("تم إلغاء تجميد المنتج بنجاح","success"),m(!1),N()):q("فشل في إلغاء تجميد المنتج","error")}catch(e){console.error("Error unfreezing product:",e),q("حدث خطأ أثناء إلغاء تجميد المنتج","error")}};return(0,s.jsxs)(s.Fragment,{children:[s.jsx(o,{message:j.message,type:j.type,isVisible:j.isVisible,onClose:()=>w(e=>({...e,isVisible:!1}))}),s.jsx(a.default,{navbarTitle:"عرض المنتجات",onBack:()=>window.history.back(),menuOptions:[{label:"إضافة منتج جديد",onClick:()=>window.location.href="/inventory/new-product"},{label:"تصدير البيانات",onClick:()=>q("سيتم إضافة ميزة التصدير قريباً","info")}],children:(0,s.jsxs)("div",{className:"space-y-6",children:[s.jsx("div",{className:"bg-white rounded-lg p-4 shadow-sm",dir:"rtl",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2 space-x-reverse",children:[s.jsx("div",{className:"flex-1",children:s.jsx("input",{type:"text",id:"search",value:c,onChange:e=>d(e.target.value),placeholder:"بحث بالاسم",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 bg-white"})}),s.jsx("button",{onClick:()=>g(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V6a1 1 0 00-1-1H5a1 1 0 00-1 1v1a1 1 0 001 1zm12 0h2a1 1 0 001-1V6a1 1 0 00-1-1h-2a1 1 0 00-1 1v1a1 1 0 001 1zM5 20h2a1 1 0 001-1v-1a1 1 0 00-1-1H5a1 1 0 00-1 1v1a1 1 0 001 1z"})})})]})}),r?s.jsx("div",{className:"flex justify-center items-center py-8",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):(0,s.jsxs)("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",dir:"rtl",children:[s.jsx("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[s.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المنتج"}),s.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"السعر"}),s.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الكمية"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:k.map(e=>(0,s.jsxs)("tr",{onClick:()=>C(e),className:"hover:bg-gray-50 cursor-pointer",children:[s.jsx("td",{className:"px-3 py-3 whitespace-nowrap",children:(0,s.jsxs)("div",{className:"text-xs font-medium text-gray-900 truncate max-w-24",children:[e.name,!e.isActive&&s.jsx("span",{className:"ml-1 text-red-500 text-xs",children:"(مجمد)"})]})}),s.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-xs text-gray-900",children:e.price.toFixed(2)}),s.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-xs text-gray-900",children:e.stock})]},e.id))})]})}),0===k.length&&s.jsx("div",{className:"text-center py-8",children:s.jsx("p",{className:"text-gray-500",children:"لا توجد منتجات مطابقة للبحث"})})]})]})}),p&&u&&s.jsx("div",{className:"fixed top-0 left-0 right-0 bottom-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg p-4 w-full max-w-sm mx-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[s.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"تعديل سريع"}),s.jsx("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"اسم المنتج"}),s.jsx("p",{className:"text-sm text-gray-900 font-medium truncate",children:u.name})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{htmlFor:"quick-stock",className:"block text-xs font-medium text-gray-700 mb-1",children:"الكمية المتوفرة"}),s.jsx("input",{type:"number",id:"quick-stock",value:y.stock,onChange:e=>f(t=>({...t,stock:e.target.value})),className:"w-full px-2 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 bg-white text-sm",min:"0"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{htmlFor:"quick-price",className:"block text-xs font-medium text-gray-700 mb-1",children:"السعر"}),s.jsx("input",{type:"number",id:"quick-price",value:y.price,onChange:e=>f(t=>({...t,price:e.target.value})),className:"w-full px-2 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 bg-white text-sm",min:"0",step:"0.01"})]})]}),(0,s.jsxs)("div",{className:"flex flex-col space-y-1.5 mt-4",children:[s.jsx("button",{onClick:P,disabled:b,className:"w-full bg-blue-600 text-white py-1.5 px-3 rounded-md hover:bg-blue-700 disabled:opacity-50 text-sm",children:b?"جاري التحديث...":"تحديث سريع"}),s.jsx("button",{onClick:()=>window.location.href=`/inventory/edit-product/${u.id}`,className:"w-full bg-gray-600 text-white py-1.5 px-3 rounded-md hover:bg-gray-700 text-sm",children:"تعديل متقدم"}),u.isActive?s.jsx("button",{onClick:()=>M(u.id),className:"w-full bg-yellow-600 text-white py-1.5 px-3 rounded-md hover:bg-yellow-700 text-sm",children:"تجميد مؤقت"}):s.jsx("button",{onClick:()=>_(u.id),className:"w-full bg-green-600 text-white py-1.5 px-3 rounded-md hover:bg-green-700 text-sm",children:"إلغاء التجميد"}),s.jsx("button",{onClick:()=>L(u.id),className:"w-full bg-red-600 text-white py-1.5 px-3 rounded-md hover:bg-red-700 text-sm",children:"حذف المنتج"})]})]})}),s.jsx(n.Z,{isVisible:h,onResult:e=>{d(e),g(!1),q(`تم قراءة الباركود: ${e}`,"success")},onClose:()=>g(!1)})]})}},75688:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>a,__esModule:()=>i,default:()=>o});let s=(0,r(86843).createProxy)(String.raw`C:\Users\PC\Desktop\micropos\app\inventory\products\page.tsx`),{__esModule:i,$$typeof:a}=s,o=s.default}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[638,969,168,369],()=>r(16867));module.exports=s})();