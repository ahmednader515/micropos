(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[798],{4018:function(e,t,s){Promise.resolve().then(s.bind(s,9897))},9897:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var r=s(7437),a=s(2265),i=s(453);function l(e){let{message:t,type:s,isVisible:i,onClose:l,duration:n=4e3}=e,[c,o]=(0,a.useState)(!1);return((0,a.useEffect)(()=>{if(i){o(!0);let e=setTimeout(()=>{o(!1),setTimeout(l,300)},n);return()=>clearTimeout(e)}},[i,n,l]),i)?(0,r.jsx)("div",{className:"fixed top-4 left-4 right-4 z-50 transform transition-all duration-300 ".concat(c?"translate-y-0 opacity-100":"-translate-y-2 opacity-0"),children:(0,r.jsx)("div",{className:"max-w-sm mx-auto border rounded-lg p-4 shadow-lg ".concat((()=>{switch(s){case"success":return"bg-green-50 border-green-200 text-green-800";case"error":return"bg-red-50 border-red-200 text-red-800";case"info":return"bg-blue-50 border-blue-200 text-blue-800";default:return"bg-gray-50 border-gray-200 text-gray-800"}})()),children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(()=>{switch(s){case"success":return(0,r.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})});case"error":return(0,r.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})});case"info":return(0,r.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})});default:return null}})()}),(0,r.jsx)("div",{className:"mr-3 flex-1",children:(0,r.jsx)("p",{className:"text-sm font-medium",children:t})}),(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("button",{onClick:()=>{o(!1),setTimeout(l,300)},className:"inline-flex text-gray-400 hover:text-gray-600 focus:outline-none",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})})]})})}):null}var n=s(9519);function c(){let[e,t]=(0,a.useState)([]),[s,c]=(0,a.useState)(!0),[o,d]=(0,a.useState)(""),[u,x]=(0,a.useState)(null),[h,m]=(0,a.useState)(!1),[p,g]=(0,a.useState)(!1),[f,b]=(0,a.useState)({stock:"",price:""}),[y,v]=(0,a.useState)(!1),[j,w]=(0,a.useState)({message:"",type:"info",isVisible:!1});(0,a.useEffect)(()=>{N()},[]);let N=async()=>{try{let e=await fetch("/api/products/inventory");if(e.ok){let s=await e.json();t(s.products)}}catch(e){console.error("Error fetching products:",e)}finally{c(!1)}},k=e.filter(e=>e.name.toLowerCase().includes(o.toLowerCase())||e.barcode&&e.barcode.toLowerCase().includes(o.toLowerCase())||e.sku&&e.sku.toLowerCase().includes(o.toLowerCase())),C=e=>{x(e),b({stock:e.stock.toString(),price:e.price.toString()}),m(!0)},L=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";w({message:e,type:t,isVisible:!0})},z=async()=>{if(u){v(!0);try{(await fetch("/api/products/".concat(u.id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({stock:parseInt(f.stock),price:parseFloat(f.price)})})).ok?(L("تم تحديث المنتج بنجاح","success"),m(!1),N()):L("فشل في تحديث المنتج","error")}catch(e){console.error("Error updating product:",e),L("حدث خطأ أثناء تحديث المنتج","error")}finally{v(!1)}}},S=async e=>{if(confirm("هل أنت متأكد من حذف هذا المنتج؟"))try{(await fetch("/api/products/".concat(e),{method:"DELETE"})).ok?(L("تم حذف المنتج بنجاح","success"),m(!1),N()):L("فشل في حذف المنتج","error")}catch(e){console.error("Error deleting product:",e),L("حدث خطأ أثناء حذف المنتج","error")}},M=async e=>{try{(await fetch("/api/products/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:!1})})).ok?(L("تم تجميد المنتج بنجاح","success"),m(!1),N()):L("فشل في تجميد المنتج","error")}catch(e){console.error("Error freezing product:",e),L("حدث خطأ أثناء تجميد المنتج","error")}},E=async e=>{try{(await fetch("/api/products/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:!0})})).ok?(L("تم إلغاء تجميد المنتج بنجاح","success"),m(!1),N()):L("فشل في إلغاء تجميد المنتج","error")}catch(e){console.error("Error unfreezing product:",e),L("حدث خطأ أثناء إلغاء تجميد المنتج","error")}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l,{message:j.message,type:j.type,isVisible:j.isVisible,onClose:()=>w(e=>({...e,isVisible:!1}))}),(0,r.jsx)(i.default,{navbarTitle:"عرض المنتجات",onBack:()=>window.history.back(),menuOptions:[{label:"إضافة منتج جديد",onClick:()=>window.location.href="/inventory/new-product"},{label:"تصدير البيانات",onClick:()=>L("سيتم إضافة ميزة التصدير قريباً","info")}],children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"bg-white rounded-lg p-4 shadow-sm",dir:"rtl",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2 space-x-reverse",children:[(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsx)("input",{type:"text",id:"search",value:o,onChange:e=>d(e.target.value),placeholder:"بحث بالاسم",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 bg-white"})}),(0,r.jsx)("button",{onClick:()=>g(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors",children:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V6a1 1 0 00-1-1H5a1 1 0 00-1 1v1a1 1 0 001 1zm12 0h2a1 1 0 001-1V6a1 1 0 00-1-1h-2a1 1 0 00-1 1v1a1 1 0 001 1zM5 20h2a1 1 0 001-1v-1a1 1 0 00-1-1H5a1 1 0 00-1 1v1a1 1 0 001 1z"})})})]})}),s?(0,r.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):(0,r.jsxs)("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",dir:"rtl",children:[(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المنتج"}),(0,r.jsx)("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"السعر"}),(0,r.jsx)("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الكمية"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:k.map(e=>(0,r.jsxs)("tr",{onClick:()=>C(e),className:"hover:bg-gray-50 cursor-pointer",children:[(0,r.jsx)("td",{className:"px-3 py-3 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"text-xs font-medium text-gray-900 truncate max-w-24",children:[e.name,!e.isActive&&(0,r.jsx)("span",{className:"ml-1 text-red-500 text-xs",children:"(مجمد)"})]})}),(0,r.jsx)("td",{className:"px-3 py-3 whitespace-nowrap text-xs text-gray-900",children:e.price.toFixed(2)}),(0,r.jsx)("td",{className:"px-3 py-3 whitespace-nowrap text-xs text-gray-900",children:e.stock})]},e.id))})]})}),0===k.length&&(0,r.jsx)("div",{className:"text-center py-8",children:(0,r.jsx)("p",{className:"text-gray-500",children:"لا توجد منتجات مطابقة للبحث"})})]})]})}),h&&u&&(0,r.jsx)("div",{className:"fixed top-0 left-0 right-0 bottom-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-4 w-full max-w-sm mx-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h3",{className:"text-base font-semibold text-gray-900",children:"تعديل سريع"}),(0,r.jsx)("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600",children:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"اسم المنتج"}),(0,r.jsx)("p",{className:"text-sm text-gray-900 font-medium truncate",children:u.name})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"quick-stock",className:"block text-xs font-medium text-gray-700 mb-1",children:"الكمية المتوفرة"}),(0,r.jsx)("input",{type:"number",id:"quick-stock",value:f.stock,onChange:e=>b(t=>({...t,stock:e.target.value})),className:"w-full px-2 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 bg-white text-sm",min:"0"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"quick-price",className:"block text-xs font-medium text-gray-700 mb-1",children:"السعر"}),(0,r.jsx)("input",{type:"number",id:"quick-price",value:f.price,onChange:e=>b(t=>({...t,price:e.target.value})),className:"w-full px-2 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 bg-white text-sm",min:"0",step:"0.01"})]})]}),(0,r.jsxs)("div",{className:"flex flex-col space-y-1.5 mt-4",children:[(0,r.jsx)("button",{onClick:z,disabled:y,className:"w-full bg-blue-600 text-white py-1.5 px-3 rounded-md hover:bg-blue-700 disabled:opacity-50 text-sm",children:y?"جاري التحديث...":"تحديث سريع"}),(0,r.jsx)("button",{onClick:()=>window.location.href="/inventory/edit-product/".concat(u.id),className:"w-full bg-gray-600 text-white py-1.5 px-3 rounded-md hover:bg-gray-700 text-sm",children:"تعديل متقدم"}),u.isActive?(0,r.jsx)("button",{onClick:()=>M(u.id),className:"w-full bg-yellow-600 text-white py-1.5 px-3 rounded-md hover:bg-yellow-700 text-sm",children:"تجميد مؤقت"}):(0,r.jsx)("button",{onClick:()=>E(u.id),className:"w-full bg-green-600 text-white py-1.5 px-3 rounded-md hover:bg-green-700 text-sm",children:"إلغاء التجميد"}),(0,r.jsx)("button",{onClick:()=>S(u.id),className:"w-full bg-red-600 text-white py-1.5 px-3 rounded-md hover:bg-red-700 text-sm",children:"حذف المنتج"})]})]})}),(0,r.jsx)(n.Z,{isVisible:p,onResult:e=>{d(e),g(!1),L("تم قراءة الباركود: ".concat(e),"success")},onClose:()=>g(!1)})]})}}},function(e){e.O(0,[186,987,971,458,744],function(){return e(e.s=4018)}),_N_E=e.O()}]);