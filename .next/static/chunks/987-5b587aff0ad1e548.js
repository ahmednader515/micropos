"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[987],{9519:function(e,s,a){a.d(s,{Z:function(){return i}});var r=a(7437),t=a(9102),c=a.n(t),l=a(2265),o=a(9130),d=a(4930),n=a.n(d);function i(e){let{onResult:s,onClose:a,isVisible:t}=e,[d,i]=(0,l.useState)(""),[x,m]=(0,l.useState)(!1),[h,u]=(0,l.useState)("image"),[g,j]=(0,l.useState)(!1),b=(0,l.useRef)(null),p=(0,l.useRef)(null);(0,l.useEffect)(()=>()=>{g&&n().stop()},[g]),(0,l.useEffect)(()=>{!t&&g&&(n().stop(),j(!1))},[t,g]),(0,l.useEffect)(()=>{console.log("Camera container ref changed:",p.current)},[p.current]);let f=()=>{console.log("startCamera called"),console.log("Quagga available:",void 0!==n()),console.log("navigator.mediaDevices available:",!!navigator.mediaDevices),console.log("Camera container ref:",p.current),setTimeout(()=>{if(!p.current){console.error("Camera container ref is null after delay"),i("خطأ في تهيئة الكاميرا");return}console.log("Starting camera..."),i(""),j(!0);try{n().stop()}catch(e){console.log("No existing Quagga instance to stop")}if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){i("متصفحك لا يدعم الوصول إلى الكاميرا"),j(!1);return}navigator.mediaDevices.getUserMedia({video:!0}).then(e=>{console.log("Camera access granted, stream:",e),e.getTracks().forEach(e=>e.stop()),v()}).catch(e=>{console.error("Camera access denied:",e),i("تم رفض الوصول إلى الكاميرا. تأكد من السماح بالوصول إلى الكاميرا."),j(!1)})},100)},v=()=>{if(!p.current){console.error("Camera container ref is null in initializeQuagga"),i("خطأ في تهيئة الكاميرا"),j(!1);return}let e={inputStream:{name:"Live",type:"LiveStream",target:p.current,constraints:{width:{min:320,ideal:640,max:1280},height:{min:180,ideal:360,max:720},facingMode:"environment",aspectRatio:16/9}},locator:{patchSize:"large",halfSample:!1},numOfWorkers:4,frequency:25,decoder:{readers:["code_128_reader","ean_reader","ean_8_reader","code_39_reader","code_39_vin_reader","codabar_reader","upc_reader","upc_e_reader","i2of5_reader"]},locate:!0};console.log("Initializing Quagga with config:",e),n().init(e,e=>{if(e){console.error("Quagga initialization error:",e);let s={inputStream:{name:"Live",type:"LiveStream",target:p.current,constraints:{width:640,height:360,facingMode:"environment",aspectRatio:16/9}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:2,frequency:15,decoder:{readers:["code_128_reader","ean_reader","code_39_reader"]},locate:!0};console.log("Trying with simpler config..."),n().init(s,e=>{if(e){console.error("Quagga simple config also failed:",e),i("فشل في تشغيل الكاميرا. تأكد من السماح بالوصول إلى الكاميرا."),j(!1);return}console.log("Quagga initialized successfully with simple config"),n().start()});return}console.log("Quagga initialized successfully"),n().start()}),n().onDetected(e=>{let a=e.codeResult.code;console.log("Barcode detected:",a),s(a),n().stop(),j(!1)}),n().onProcessed(e=>{e&&console.log("Frame processed")})},y=()=>{n().stop(),j(!1)},N=async e=>{var a;let r=null===(a=e.target.files)||void 0===a?void 0:a[0];if(r){m(!0),i("");try{let e=new o.BrowserMultiFormatReader,a=URL.createObjectURL(r),t=new Image;t.onload=async()=>{try{let a=await e.decodeFromImage(t);s(a.getText())}catch(e){console.error("ZXing decode error:",e),i("لم يتم العثور على باركود في الصورة. تأكد من أن الصورة واضحة وتحتوي على باركود.")}finally{m(!1),URL.revokeObjectURL(a),b.current&&(b.current.value="")}},t.onerror=()=>{i("حدث خطأ في تحميل الصورة. تأكد من أن الملف صحيح."),m(!1),URL.revokeObjectURL(a),b.current&&(b.current.value="")},t.src=a}catch(e){console.error("Image scan error:",e),i("حدث خطأ أثناء قراءة الصورة. تأكد من أن الصورة واضحة."),m(!1),b.current&&(b.current.value="")}}},w=e=>{g&&y(),u(e),i("")};return t?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c(),{id:"a37c90c11d2d9559",children:'input[type="file"].jsx-a37c90c11d2d9559{color:black!important}input[type="text"].jsx-a37c90c11d2d9559{color:black!important}input[type="number"].jsx-a37c90c11d2d9559{color:black!important}textarea.jsx-a37c90c11d2d9559{color:black!important}select.jsx-a37c90c11d2d9559{color:black!important}'}),(0,r.jsx)("div",{className:"jsx-a37c90c11d2d9559 fixed top-0 left-0 right-0 bottom-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{style:{color:"black"},className:"jsx-a37c90c11d2d9559 bg-white rounded-lg p-3 w-full max-w-sm sm:max-w-md mx-4 max-h-[95vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"jsx-a37c90c11d2d9559 flex justify-between items-center mb-3",children:[(0,r.jsx)("h3",{className:"jsx-a37c90c11d2d9559 text-base font-semibold text-gray-900",children:"قارئ الباركود"}),(0,r.jsx)("button",{onClick:a,className:"jsx-a37c90c11d2d9559 text-gray-400 hover:text-gray-600",children:(0,r.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"jsx-a37c90c11d2d9559 w-5 h-5",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12",className:"jsx-a37c90c11d2d9559"})})})]}),d&&(0,r.jsx)("div",{className:"jsx-a37c90c11d2d9559 mb-3 p-2 bg-red-100 border border-red-400 text-red-700 rounded-md text-xs",children:d}),(0,r.jsx)("div",{className:"jsx-a37c90c11d2d9559 mb-4",children:(0,r.jsxs)("div",{className:"jsx-a37c90c11d2d9559 flex bg-gray-100 rounded-lg p-1",children:[(0,r.jsx)("button",{onClick:()=>w("image"),className:"jsx-a37c90c11d2d9559 "+"flex-1 py-2 px-3 text-xs rounded-md transition-colors ".concat("image"===h?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"),children:"\uD83D\uDCF7 رفع صورة"}),(0,r.jsx)("button",{onClick:()=>w("camera"),className:"jsx-a37c90c11d2d9559 "+"flex-1 py-2 px-3 text-xs rounded-md transition-colors ".concat("camera"===h?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"),children:"\uD83D\uDCF9 كاميرا مباشرة"})]})}),"image"===h?(0,r.jsxs)("div",{className:"jsx-a37c90c11d2d9559 text-center",children:[(0,r.jsx)("div",{className:"jsx-a37c90c11d2d9559 mb-3",children:(0,r.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"jsx-a37c90c11d2d9559 w-12 h-12 mx-auto text-gray-400",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z",className:"jsx-a37c90c11d2d9559"})})}),(0,r.jsx)("p",{className:"jsx-a37c90c11d2d9559 text-black mb-3 text-sm",children:"اختر صورة تحتوي على باركود"}),(0,r.jsxs)("div",{className:"jsx-a37c90c11d2d9559 text-center text-xs text-gray-500 mb-3",children:[(0,r.jsx)("p",{className:"jsx-a37c90c11d2d9559",children:"نصائح للصور:"}),(0,r.jsx)("p",{className:"jsx-a37c90c11d2d9559",children:"• تأكد من أن الباركود واضح ومضاء جيداً"}),(0,r.jsx)("p",{className:"jsx-a37c90c11d2d9559",children:"• تجنب الظلال والانعكاسات"}),(0,r.jsx)("p",{className:"jsx-a37c90c11d2d9559",children:"• استخدم صور عالية الدقة"})]}),(0,r.jsx)("input",{ref:b,type:"file",accept:"image/*",onChange:N,className:"jsx-a37c90c11d2d9559 hidden"}),(0,r.jsx)("button",{onClick:()=>{var e;return null===(e=b.current)||void 0===e?void 0:e.click()},disabled:x,className:"jsx-a37c90c11d2d9559 bg-blue-600 text-white px-4 py-1.5 rounded-md hover:bg-blue-700 transition-colors text-sm disabled:opacity-50",children:x?"جاري المعالجة...":"اختيار صورة"})]}):(0,r.jsxs)("div",{className:"jsx-a37c90c11d2d9559 text-center",children:[(0,r.jsx)("div",{className:"jsx-a37c90c11d2d9559 mb-3",children:(0,r.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"jsx-a37c90c11d2d9559 w-12 h-12 mx-auto text-gray-400",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z",className:"jsx-a37c90c11d2d9559"})})}),(0,r.jsxs)("div",{ref:p,className:"jsx-a37c90c11d2d9559 "+"w-full aspect-video rounded-lg overflow-hidden mb-3 relative ".concat(g?"bg-gray-100":"bg-gray-200"),children:[!g&&(0,r.jsx)("div",{className:"jsx-a37c90c11d2d9559 flex items-center justify-center h-full text-gray-500",children:(0,r.jsxs)("div",{className:"jsx-a37c90c11d2d9559 text-center",children:[(0,r.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"jsx-a37c90c11d2d9559 w-8 h-8 mx-auto mb-2",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z",className:"jsx-a37c90c11d2d9559"})}),(0,r.jsx)("p",{className:"jsx-a37c90c11d2d9559 text-xs",children:"كاميرا غير نشطة"})]})}),g&&(0,r.jsxs)("div",{className:"jsx-a37c90c11d2d9559 absolute inset-0 pointer-events-none",children:[(0,r.jsx)("div",{className:"jsx-a37c90c11d2d9559 absolute top-2 left-2 sm:top-4 sm:left-4 w-6 h-6 sm:w-8 sm:h-8 border-l-2 border-t-2 border-green-500"}),(0,r.jsx)("div",{className:"jsx-a37c90c11d2d9559 absolute top-2 right-2 sm:top-4 sm:right-4 w-6 h-6 sm:w-8 sm:h-8 border-r-2 border-t-2 border-green-500"}),(0,r.jsx)("div",{className:"jsx-a37c90c11d2d9559 absolute bottom-2 left-2 sm:bottom-4 sm:left-4 w-6 h-6 sm:w-8 sm:h-8 border-l-2 border-b-2 border-green-500"}),(0,r.jsx)("div",{className:"jsx-a37c90c11d2d9559 absolute bottom-2 right-2 sm:bottom-4 sm:right-4 w-6 h-6 sm:w-8 sm:h-8 border-r-2 border-b-2 border-green-500"}),(0,r.jsx)("div",{className:"jsx-a37c90c11d2d9559 absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-40 h-12 sm:w-48 sm:h-16 border-2 border-green-500 border-dashed"}),(0,r.jsx)("div",{className:"jsx-a37c90c11d2d9559 absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-40 h-1 sm:w-48 sm:h-1 bg-green-500 animate-pulse"})]})]}),g?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:"jsx-a37c90c11d2d9559 text-black mb-3 text-sm",children:"وجه الكاميرا نحو الباركود"}),(0,r.jsx)("button",{onClick:y,className:"jsx-a37c90c11d2d9559 bg-red-600 text-white px-4 py-1.5 rounded-md hover:bg-red-700 transition-colors text-sm",children:"إيقاف الكاميرا"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:"jsx-a37c90c11d2d9559 text-black mb-3 text-sm",children:"استخدم الكاميرا لمسح الباركود"}),(0,r.jsxs)("div",{className:"jsx-a37c90c11d2d9559 text-center text-xs text-gray-500 mb-3",children:[(0,r.jsx)("p",{className:"jsx-a37c90c11d2d9559",children:"نصائح للمسح:"}),(0,r.jsx)("p",{className:"jsx-a37c90c11d2d9559",children:"• ضع الباركود في وسط الإطار المحدد"}),(0,r.jsx)("p",{className:"jsx-a37c90c11d2d9559",children:"• تأكد من إضاءة جيدة وعدم وجود ظلال"}),(0,r.jsx)("p",{className:"jsx-a37c90c11d2d9559",children:"• حافظ على الكاميرا ثابتة على بعد 10-20 سم"}),(0,r.jsx)("p",{className:"jsx-a37c90c11d2d9559",children:"• تأكد من أن الباركود واضح وغير مكسور"})]}),(0,r.jsx)("button",{onClick:()=>{console.log("Camera button clicked"),f()},className:"jsx-a37c90c11d2d9559 bg-green-600 text-white px-4 py-1.5 rounded-md hover:bg-green-700 transition-colors text-sm",children:"تشغيل الكاميرا"})]})]})]})})]}):null}},453:function(e,s,a){a.r(s),a.d(s,{default:function(){return n}});var r=a(7437),t=a(2265);let c=["تعديل فاتورة مبيعات","تعديل فاتورة مشتريات","الغاء فاتورة مبيعات/مشتريات","الغاء مبلغ - صندوق/مصروفات","الغاء سند - قبض/صرف","ارجاع فاتورة مبيعات","ارجاع فاتورة مشتريات","الغاء فاتورة مرتجع مبيعات","التحويل بين العملاء و الموردين","معالجة المنتجات التالفة","شاشة عرض الأسعار"],l=["الاعدادات","الضرائب","الطابعه"],o=["النسخ الاحتياطي للبيانات"];function d(e){let{onClose:s}=e;return(0,r.jsxs)("div",{className:"flex h-full w-64 flex-col bg-white border-l border-gray-200",dir:"rtl",children:[(0,r.jsxs)("div",{className:"flex h-16 items-center justify-between border-b border-gray-200 px-4 flex-shrink-0",children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"مايكرو POS"}),(0,r.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-700 lg:hidden",children:(0,r.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("div",{className:"flex-1 px-4 py-4 space-y-6 overflow-y-auto",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-gray-700 font-bold mb-2",children:"معالجات متقدمة"}),(0,r.jsx)("ul",{className:"space-y-1",children:c.map((e,s)=>(0,r.jsx)("li",{className:"rounded bg-gray-100 text-gray-800 px-3 py-2 text-sm border border-transparent hover:bg-gray-200 transition",children:e},s))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-gray-700 font-bold mb-2",children:"اعدادات النظام"}),(0,r.jsx)("ul",{className:"space-y-1",children:l.map((e,s)=>(0,r.jsx)("li",{className:"rounded bg-gray-100 text-gray-800 px-3 py-2 text-sm border border-transparent hover:bg-gray-200 transition",children:e},s))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-gray-700 font-bold mb-2",children:"النسخ الاحتياطي"}),(0,r.jsx)("ul",{className:"space-y-1",children:o.map((e,s)=>(0,r.jsx)("li",{className:"rounded bg-gray-100 text-gray-800 px-3 py-2 text-sm border border-transparent hover:bg-gray-200 transition",children:e},s))})]})]}),(0,r.jsx)("div",{className:"border-t border-gray-200 p-4 flex-shrink-0",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"h-8 w-8 rounded-full bg-gray-300"}),(0,r.jsxs)("div",{className:"mr-3",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"مشرف النظام"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"admin@micropos.com"})]})]})})]})}function n(e){let{children:s,navbarTitle:a,onBack:c,menuOptions:l,hideNavbar:o}=e,[n,i]=(0,t.useState)(!1),[x,m]=(0,t.useState)(!1);return(0,r.jsxs)("div",{className:"flex h-screen bg-gray-100",children:[n&&(0,r.jsx)("div",{className:"fixed inset-0 z-40 bg-gray-600 bg-opacity-75 lg:hidden",onClick:()=>i(!1)}),(0,r.jsx)("div",{className:"fixed inset-y-0 right-0 z-50 w-64 transform transition-transform duration-300 ease-in-out lg:relative lg:translate-x-0 ".concat(n?"translate-x-0":"translate-x-full"),children:(0,r.jsx)(d,{onClose:()=>i(!1)})}),(0,r.jsxs)("main",{className:"flex-1 overflow-auto",children:[!o&&(0,r.jsx)("div",{className:"sticky top-0 z-30 shadow-sm lg:hidden ".concat(a?"bg-white":"bg-gradient-to-l from-blue-600 to-purple-600"),children:a?(0,r.jsxs)("div",{className:"flex items-center justify-between px-2 py-3 relative",children:[(0,r.jsx)("button",{onClick:c,className:"text-gray-500 hover:text-gray-700 focus:outline-none focus:text-gray-700 px-2",style:{minWidth:40},children:(0,r.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,r.jsx)("div",{className:"flex-1 flex justify-center",children:(0,r.jsx)("h1",{className:"text-lg font-semibold text-gray-900 truncate",children:a})}),(0,r.jsxs)("div",{className:"relative",style:{minWidth:40},children:[(0,r.jsx)("button",{onClick:()=>m(e=>!e),className:"text-gray-500 hover:text-gray-700 focus:outline-none focus:text-gray-700 px-2",children:(0,r.jsxs)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,r.jsx)("circle",{cx:"12",cy:"12",r:"1.5"}),(0,r.jsx)("circle",{cx:"19.5",cy:"12",r:"1.5"}),(0,r.jsx)("circle",{cx:"4.5",cy:"12",r:"1.5"})]})}),x&&l&&l.length>0&&(0,r.jsx)("div",{className:"absolute left-0 mt-2 w-48 bg-white border border-gray-200 rounded shadow-lg z-50 max-h-64 overflow-y-auto",children:l.map((e,s)=>(0,r.jsx)("button",{onClick:()=>{m(!1),e.onClick()},className:"block w-full text-right px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",children:e.label},s))})]})]}):(0,r.jsxs)("div",{className:"flex items-center justify-between px-4 py-3",children:[(0,r.jsx)("button",{onClick:()=>i(!0),className:"text-white hover:text-gray-100 focus:outline-none focus:text-gray-100",children:(0,r.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),(0,r.jsx)("h1",{className:"text-lg font-semibold text-white",children:"microPOS"}),(0,r.jsx)("div",{className:"w-6"})," "]})}),(0,r.jsx)("div",{className:"p-4 lg:p-6",children:s})]})]})}}}]);